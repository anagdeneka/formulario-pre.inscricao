<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pré-Inscrição: Formação de Técnicos da Alimentação e Nutricionistas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #EBF2F0; }
        .form-input, .form-select { transition: all 0.3s ease-in-out; }
        .form-input:focus, .form-select:focus { border-color: #3B82F6; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.4); }
        .error-input { border-color: #EF4444 !important; box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.4); }
        .error-text { color: #DC2626; font-size: 0.875rem; height: 1.25rem; }
        .hidden { display: none; }
        #loading-spinner { display: none; }
    </style>
</head>
<body class="font-sans">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
        
        <div class="w-full rounded-lg overflow-hidden mb-6 shadow-lg">
            <!-- IMAGEM CORRIGIDA -->
            <img src="https://images.unsplash.com/photo-1543353071-873f6b6a2082?q=80&w=2070&auto=format&fit=crop" alt="Banner do evento com alimentos saudáveis" class="w-full h-auto object-cover">
        </div>

        <div id="form-container" class="bg-white p-8 rounded-lg shadow-lg">
            <div class="text-center mb-6">
                <h1 class="text-3xl md:text-4xl font-bold text-gray-800">Formação para Técnicos da Alimentação e Nutricionistas</h1>
                <p class="text-gray-600 mt-4">
                    Pré-inscrição para a formação de Técnicos da alimentação e Nutricionistas.
                    <br>
                    O evento ocorrerá dias 7, 8 e 9 de outubro de 2025 em Curitiba - podendo sofrer alterações.
                    <br>
                    <strong>O preenchimento deste formulário não garante a vaga automaticamente, porém é necessário o preenchimento para a participação.</strong>
                </p>
            </div>

            <form id="pre-inscricao-form" novalidate>
                <div class="space-y-6">
                    
                    <fieldset class="border-t border-gray-200 pt-6">
                        <legend class="text-lg font-semibold text-gray-900 mb-2">Termo de Pré-inscrição</legend>
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-md">
                            <p class="text-sm text-yellow-800 mb-3">Este formulário é uma pré-inscrição, não garantindo sua vaga. Também pode sofrer alterações de data e local, então fique atento para possíveis mudanças.</p>
                            <div class="flex items-start">
                                <input id="termo_pre_inscricao" name="termo_pre_inscricao" type="checkbox" class="h-4 w-4 mt-0.5 rounded border-gray-400 text-blue-600 focus:ring-blue-500">
                                <label for="termo_pre_inscricao" class="ml-3 block text-sm font-medium text-gray-700">Estou ciente</label>
                            </div>
                        </div>
                        <div id="termo_pre_inscricao-error" class="error-text mt-1"></div>
                    </fieldset>

                    <!-- DADOS PESSOAIS -->
                    <fieldset class="border-t border-gray-200 pt-6">
                        <legend class="text-lg font-semibold text-gray-900 mb-4">1. Dados Pessoais</legend>
                        <div class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2">
                            <div class="sm:col-span-2">
                                <label for="nome_completo" class="block text-sm font-medium text-gray-700">Nome Completo</label>
                                <input type="text" name="nome_completo" id="nome_completo" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input">
                                <div id="nome_completo-error" class="error-text mt-1"></div>
                            </div>
                            <div>
                                <label for="rg" class="block text-sm font-medium text-gray-700">RG com UF</label>
                                <input type="text" name="rg" id="rg" placeholder="Ex: 12345678 SSP/PR" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input">
                                <p class="mt-1 text-xs text-gray-500">Se possui o novo RG (CIN), pode indicar que não possui UF.</p>
                                <div id="rg-error" class="error-text mt-1"></div>
                            </div>
                            <div>
                                <label for="cpf" class="block text-sm font-medium text-gray-700">CPF</label>
                                <input type="text" name="cpf" id="cpf" placeholder="000.000.000-00" maxlength="14" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input">
                                <div id="cpf-error" class="error-text mt-1"></div>
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" name="email" id="email" placeholder="seuemail@gmail.com" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input">
                                <p class="mt-1 text-xs text-gray-500">Apenas @gmail.com ou @escola.pr.gov.br</p>
                                <div id="email-error" class="error-text mt-1"></div>
                            </div>
                            <div>
                                <label for="celular" class="block text-sm font-medium text-gray-700">Celular com DDD</label>
                                <input type="tel" name="celular" id="celular" placeholder="41999999999" maxlength="11" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input">
                                <div id="celular-error" class="error-text mt-1"></div>
                            </div>
                        </div>
                    </fieldset>

                    <!-- ENDEREÇO -->
                     <fieldset class="border-t border-gray-200 pt-6">
                        <legend class="text-lg font-semibold text-gray-900 mb-4">2. Endereço Completo</legend>
                        <div class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
                            <div class="sm:col-span-4"><label for="rua" class="block text-sm font-medium text-gray-700">Rua</label><input type="text" name="rua" id="rua" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input"><div id="rua-error" class="error-text mt-1"></div></div>
                             <div class="sm:col-span-2"><label for="numero" class="block text-sm font-medium text-gray-700">Número</label><input type="text" name="numero" id="numero" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input"><div id="numero-error" class="error-text mt-1"></div></div>
                             <div class="sm:col-span-3"><label for="bairro" class="block text-sm font-medium text-gray-700">Bairro</label><input type="text" name="bairro" id="bairro" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input"><div id="bairro-error" class="error-text mt-1"></div></div>
                             <div class="sm:col-span-3"><label for="cidade" class="block text-sm font-medium text-gray-700">Cidade</label><input type="text" name="cidade" id="cidade" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input"><div id="cidade-error" class="error-text mt-1"></div></div>
                            <div class="sm:col-span-2"><label for="cep" class="block text-sm font-medium text-gray-700">CEP</label><input type="text" name="cep" id="cep" placeholder="00000-000" maxlength="9" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input"><div id="cep-error" class="error-text mt-1"></div></div>
                        </div>
                    </fieldset>

                    <!-- DADOS PROFISSIONAIS -->
                    <fieldset class="border-t border-gray-200 pt-6">
                        <legend class="text-lg font-semibold text-gray-900 mb-4">3. Dados Profissionais</legend>
                        <div class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2">
                            <div class="sm:col-span-2"><label for="nre" class="block text-sm font-medium text-gray-700">NRE de Atuação</label><select id="nre" name="nre" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-select"><option value="">Selecione...</option><option>Área Metropolitana Norte</option><option>Área Metropolitana Sul</option><option>Apucarana</option><option>Assis Chateaubriand</option><option>Campo Mourão</option><option>Cascavel</option><option>Cianorte</option><option>Cornélio Procópio</option><option>Curitiba</option><option>Dois Vizinhos</option><option>Foz do Iguaçu</option><option>Francisco Beltrão</option><option>Goioerê</option><option>Guarapuava</option><option>Ibaiti</option><option>Irati</option><option>Ivaiporã</option><option>Jacarezinho</option><option>Laranjeiras do Sul</option><option>Loanda</option><option>Londrina</option><option>Maringá</option><option>Paranaguá</option><option>Paranavaí</option><option>Pato Branco</option><option>Pitanga</option><option>Ponta Grossa</option><option>Telêmaco Borba</option><option>Toledo</option><option>Umuarama</option><option>União da Vitória</option><option>Wenceslau Braz</option></select><div id="nre-error" class="error-text mt-1"></div></div>
                            <div class="sm:col-span-2"><label class="block text-sm font-medium text-gray-700">Sua função</label><div class="mt-2 space-y-2"><div class="flex items-center"><input id="funcao_nutricionista" name="funcao" type="radio" value="nutricionista" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"><label for="funcao_nutricionista" class="ml-3 block text-sm font-medium text-gray-700">Nutricionista</label></div><div class="flex items-center"><input id="funcao_tecnico" name="funcao" type="radio" value="tecnico" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"><label for="funcao_tecnico" class="ml-3 block text-sm font-medium text-gray-700">Técnico da Alimentação Escolar</label></div></div><div id="funcao-error" class="error-text mt-1"></div></div>
                            <div id="contrato-tecnico-container" class="sm:col-span-2 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2 hidden">
                                <div><label class="block text-sm font-medium text-gray-700">Qual o regime de contratação?</label><div class="mt-2 space-y-2"><div class="flex items-center"><input id="regime_terceirizado" name="regime_contratacao" type="radio" value="terceirizado" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"><label for="regime_terceirizado" class="ml-3 block text-sm font-medium text-gray-700">Terceirizado</label></div><div class="flex items-center"><input id="regime_qfeb" name="regime_contratacao" type="radio" value="qfeb" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"><label for="regime_qfeb" class="ml-3 block text-sm font-medium text-gray-700">QFEB</label></div></div><div id="regime_contratacao-error" class="error-text mt-1"></div></div>
                                <div id="empresa-terceirizada-container" class="hidden"><label for="empresa_terceirizada" class="block text-sm font-medium text-gray-700">Se terceirizado, qual empresa?</label><select id="empresa_terceirizada" name="empresa_terceirizada" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-select"><option value="">Selecione...</option><option>Costa Oeste</option><option>Deltalimp</option><option>Servsul</option><option>Empralimp</option><option>Pontual</option><option>Outro</option></select><div id="empresa_terceirizada-error" class="error-text mt-1"></div></div>
                            </div>
                        </div>
                    </fieldset>
                    
                    <!-- DADOS BANCÁRIOS -->
                    <fieldset class="border-t border-gray-200 pt-6">
                        <legend class="text-lg font-semibold text-gray-900 mb-2">4. Dados Bancários para Bolsa-Auxílio</legend>
                        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-md space-y-2"><p class="text-sm text-blue-800"><strong>IMPORTANTE:</strong> A bolsa-auxílio só será paga para contas corrente do <strong>BANCO DO BRASIL</strong> em nome do titular.</p><p class="text-sm text-blue-800">Conta salário, conta conjunta não solidária e conta poupança <strong>não são</strong> passíveis de pagamento.</p></div>
                        <div class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2 mt-4">
                            <div><label for="agencia" class="block text-sm font-medium text-gray-700">Agência (AG)</label><input type="text" name="agencia" id="agencia" placeholder="Ex: 1234" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input"><div id="agencia-error" class="error-text mt-1"></div></div>
                            <div><label for="conta_corrente" class="block text-sm font-medium text-gray-700">Conta Corrente (CC) com dígito</label><input type="text" name="conta_corrente" id="conta_corrente" placeholder="Ex: 123456-7" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm form-input"><div id="conta_corrente-error" class="error-text mt-1"></div></div>
                        </div>
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-md mt-6"><p class="text-sm text-yellow-800 mb-3">Caso a conta bancária não siga as instruções acima e o inscrito não seja o titular, não há como receber o valor da bolsa. Estando os dados bancários corretos, o pagamento da bolsa pode ocorrer em até 90 dias após o término do curso.</p><div class="flex items-start"><input id="termo_bancario" name="termo_bancario" type="checkbox" class="h-4 w-4 mt-0.5 rounded border-gray-400 text-blue-600 focus:ring-blue-500"><label for="termo_bancario" class="ml-3 block text-sm font-medium text-gray-700">Estou ciente e declaro que sou titular da conta.</label></div></div>
                        <div id="termo_bancario-error" class="error-text mt-1"></div>
                    </fieldset>
                </div>

                <div class="mt-8 border-t border-gray-200 pt-6">
                    <button type="submit" id="submit-button" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-300 flex items-center justify-center">
                        <span id="button-text">Enviar Pré-Inscrição</span>
                        <svg id="loading-spinner" class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Mensagens de Feedback -->
        <div id="success-message" class="hidden mt-6 bg-white p-8 rounded-lg shadow-lg text-center">
            <h2 class="text-2xl font-bold text-green-600">Pré-inscrição enviada com sucesso!</h2>
            <p class="mt-4 text-gray-700">Obrigado por se inscrever. Um e-mail de confirmação foi enviado para você. Verifique sua caixa de entrada (e a pasta de spam).</p>
        </div>
        <div id="error-message" class="hidden mt-6 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md" role="alert">
            <p class="font-bold">Ocorreu um erro.</p>
            <p>Não foi possível enviar sua inscrição. Por favor, verifique sua conexão e tente novamente.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ==================================================================
            // PASSO CRÍTICO: Cole a URL do seu Google Apps Script aqui dentro das aspas.
            // A URL é gerada quando você "Implanta" o script no Google Sheets.
            // Exemplo: const SCRIPT_URL = 'https://script.google.com/macros/s/ABCD.../exec';
            // ==================================================================
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyBgVCcipoV3jZ-6And3tqttJz6GCMPaNo05uPA67Lt8sYk08xsU9UlUKl2Pt-a1hNL/exec'; // <-- URL INSERIDA!
            
            const formContainer = document.getElementById('form-container');
            const form = document.getElementById('pre-inscricao-form');
            const submitButton = document.getElementById('submit-button');
            const buttonText = document.getElementById('button-text');
            const loadingSpinner = document.getElementById('loading-spinner');
            const successMessage = document.getElementById('success-message');
            const errorMessage = document.getElementById('error-message');

            const cpfInput = document.getElementById('cpf');
            cpfInput.addEventListener('input', (e) => { let v=e.target.value.replace(/\D/g,''); v=v.replace(/(\d{3})(\d)/,'$1.$2'); v=v.replace(/(\d{3})(\d)/,'$1.$2'); v=v.replace(/(\d{3})(\d{1,2})$/,'$1-$2'); e.target.value = v; });
            const cepInput = document.getElementById('cep');
            cepInput.addEventListener('input', (e) => { let v=e.target.value.replace(/\D/g,''); v=v.replace(/^(\d{5})(\d)/,'$1-$2'); e.target.value = v; });

            const funcaoRadios = document.querySelectorAll('input[name="funcao"]');
            const contratoTecnicoContainer = document.getElementById('contrato-tecnico-container');
            const regimeRadios = document.querySelectorAll('input[name="regime_contratacao"]');
            const empresaContainer = document.getElementById('empresa-terceirizada-container');

            funcaoRadios.forEach(r => r.addEventListener('change', (e) => {
                if (e.target.value === 'tecnico') { contratoTecnicoContainer.classList.remove('hidden'); } 
                else { contratoTecnicoContainer.classList.add('hidden'); empresaContainer.classList.add('hidden'); clearError('regime_contratacao'); clearError('empresa_terceirizada'); document.querySelectorAll('input[name="regime_contratacao"]').forEach(r => r.checked = false); document.getElementById('empresa_terceirizada').value = ''; }
            }));

            regimeRadios.forEach(r => r.addEventListener('change', (e) => {
                if (e.target.value === 'terceirizado') { empresaContainer.classList.remove('hidden'); } 
                else { empresaContainer.classList.add('hidden'); clearError('empresa_terceirizada'); document.getElementById('empresa_terceirizada').value = ''; }
            }));

            const setError = (id, msg) => { document.getElementById(id)?.classList.add('error-input'); document.getElementById(`${id}-error`).innerText = msg; };
            const clearError = (id) => { document.getElementById(id)?.classList.remove('error-input'); document.getElementById(`${id}-error`).innerText = ''; };
            const validate = (id, condition, msg) => { const el = document.getElementById(id); if (!el || !condition(el.value.trim())) { setError(id, msg); return false; } clearError(id); return true; };
            const validateCheck = (id, msg) => { if (!document.getElementById(id).checked) { setError(id, msg); return false; } clearError(id); return true; };
            const validateRadio = (name, msg) => { if (!document.querySelector(`input[name="${name}"]:checked`)) { setError(name.replace(/_/g, '-'), msg); return false; } clearError(name.replace(/_/g, '-')); return true; };

            const validateForm = () => {
                let isValid = true;
                ['termo_pre_inscricao', 'nome_completo', 'rg', 'cpf', 'email', 'celular', 'rua', 'numero', 'bairro', 'cidade', 'cep', 'nre', 'funcao', 'regime_contratacao', 'empresa_terceirizada', 'agencia', 'conta_corrente', 'termo_bancario'].forEach(clearError);
                if (!validateCheck('termo_pre_inscricao', 'Você precisa aceitar os termos.')) isValid = false;
                if (!validate('nome_completo', v => v.length > 0, 'O nome completo é obrigatório.')) isValid = false;
                if (!validate('rg', v => v.length > 0, 'O RG é obrigatório.')) isValid = false;
                if (!validate('cpf', v => /^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(v), 'Formato de CPF inválido.')) isValid = false;
                if (!validate('email', v => /^([a-zA-Z0-9._%-]+@gmail\.com|[a-zA-Z0-9._%-]+@escola\.pr\.gov\.br)$/.test(v), 'Email inválido.')) isValid = false;
                if (!validate('celular', v => /^\d{11}$/.test(v.replace(/\D/g, '')), 'Celular inválido. Digite 11 números.')) isValid = false;
                if (!validate('rua', v => v.length > 0, 'A rua é obrigatória.')) isValid = false;
                if (!validate('numero', v => v.length > 0, 'O número é obrigatório.')) isValid = false;
                if (!validate('bairro', v => v.length > 0, 'O bairro é obrigatório.')) isValid = false;
                if (!validate('cidade', v => v.length > 0, 'A cidade é obrigatória.')) isValid = false;
                if (!validate('cep', v => /^\d{5}-\d{3}$/.test(v), 'Formato de CEP inválido.')) isValid = false;
                if (!validate('nre', v => v !== '', 'Selecione um NRE.')) isValid = false;
                if (!validateRadio('funcao', 'Selecione uma função.')) isValid = false;
                const funcao = document.querySelector('input[name="funcao"]:checked');
                if (funcao && funcao.value === 'tecnico') {
                    if (!validateRadio('regime_contratacao', 'Selecione um regime.')) isValid = false;
                    const regime = document.querySelector('input[name="regime_contratacao"]:checked');
                    if (regime && regime.value === 'terceirizado') {
                        if (!validate('empresa_terceirizada', v => v !== '', 'Selecione uma empresa.')) isValid = false;
                    }
                }
                if (!validate('agencia', v => /^\d+$/.test(v), 'Agência inválida.')) isValid = false;
                if (!validate('conta_corrente', v => /^\d+-\w{1}$/.test(v), 'Formato de conta inválido.')) isValid = false;
                if (!validateCheck('termo_bancario', 'Você precisa aceitar os termos bancários.')) isValid = false;
                return isValid;
            };

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                if (SCRIPT_URL === '') {
                    alert('ERRO DE CONFIGURAÇÃO: A URL do script não foi definida no código HTML.');
                    return;
                }
                if (!validateForm()) { return; }

                buttonText.style.display = 'none';
                loadingSpinner.style.display = 'inline-block';
                submitButton.disabled = true;

                fetch(SCRIPT_URL, { method: 'POST', body: new FormData(form) })
                    .then(response => response.json())
                    .then(data => {
                        if(data.result === 'success'){
                            formContainer.classList.add('hidden');
                            successMessage.classList.remove('hidden');
                        } else { throw new Error(data.message || 'Erro desconhecido do servidor'); }
                    })
                    .catch(error => {
                        console.error('Erro no envio:', error);
                        errorMessage.classList.remove('hidden');
                    })
                    .finally(() => {
                        buttonText.style.display = 'inline-block';
                        loadingSpinner.style.display = 'none';
                        submitButton.disabled = false;
                    });
            });
        });
    </script>

</body>
</html>

